#include "QuadFormula.h"
#include "MooNMD_Io.h"

TQuadFormula::TQuadFormula(QuadratureFormula_type id)
: type{id}
{
  switch(type)
  {
    case QuadratureFormula_type::Gauss1Line:
      Weights = {2};
      Xi = {0};
      break;
    case QuadratureFormula_type::Gauss2Line:
      Weights = {1, 1};
      Xi = {0.21132486540518711774, 0.78867513459481288226};
      for(int i=0;i<2;i++)
        Xi[i] = 2*Xi[i]-1;
      break;
    case QuadratureFormula_type::Gauss3Line:
      Weights = {0.2777777777777778,0.4444444444444444,0.2777777777777778};
      Xi = {0.11270166537925831149, 0.5, 0.88729833462074168851};
      for(int i=0;i<3;i++)
      {
        Weights[i] *= 2;
        Xi[i] = 2*Xi[i]-1;
      }
      break;
    case QuadratureFormula_type::Gauss4Line:
      Weights = { 0.347854845137453857373063949,
                  0.652145154862546142626936051,
                  0.652145154862546142626936051,
                  0.347854845137453857373063949 };
      Xi = { -0.86113631159405257522394649,
             -0.33998104358485626480266576,
              0.33998104358485626480266576,
              0.86113631159405257522394649 };
      break;
    case QuadratureFormula_type::Gauss5Line:
      Xi ={ -0.906179845938663992797626878,
            -0.538469310105683091036314421,
             0,
             0.538469310105683091036314421,
             0.906179845938663992797626878 };
      Weights ={ 0.236926885056189087514264041,
                 0.478628670499366468041291515,
                 0.568888888888888888888888889,
                 0.478628670499366468041291515,
                 0.236926885056189087514264041, };
      break;
    case QuadratureFormula_type::Gauss6Line:
      Xi = { -0.932469514203152027812301554495,
             -0.661209386466264513661399595021,
             -0.238619186083196908630501721681,
              0.238619186083196908630501721681,
              0.661209386466264513661399595021, 
              0.932469514203152027812301554495};
      Weights = { 0.171324492379170345040296142175,
                  0.360761573048138607569833513836,
                  0.467913934572691047389870343990,
                  0.467913934572691047389870343990,
                  0.360761573048138607569833513836, 
                  0.171324492379170345040296142175 };
      break;
    case QuadratureFormula_type::Gauss7Line:
      Xi = { -0.949107912342758524526189684048,
             -0.741531185599394439863864773281,
             -0.405845151377397166906606412077,
              0,
              0.405845151377397166906606412077,
              0.741531185599394439863864773281, 
              0.949107912342758524526189684048 };
      Weights = { 0.129484966168869693270611432679,
                  0.279705391489276667901467771426,
                  0.381830050505118944950369775484,
                  0.417959183673469387755102040812,
                  0.381830050505118944950369775484,
                  0.279705391489276667901467771426,
                  0.129484966168869693270611432679 };
      break;
    case QuadratureFormula_type::Gauss8Line:
      Xi = { -0.960289856497536231683560868569,
             -0.796666477413626739591553936476,
             -0.525532409916328985817739049189,
             -0.183434642495649804939476142360,
              0.183434642495649804939476142360, 
              0.525532409916328985817739049189,
              0.796666477413626739591553936476, 
              0.960289856497536231683560868569 };
      Weights = { 0.101228536290376259152531354312,
                  0.222381034453374470544355994424,
                  0.313706645877887287337962201982,
                  0.362683783378361982965150449268,
                  0.362683783378361982965150449268,
                  0.313706645877887287337962201982,
                  0.222381034453374470544355994424,
                  0.101228536290376259152531354312 };
      break;
    case QuadratureFormula_type::Gauss9Line:
      Xi = { -0.968160239507626089835576202904,
             -0.836031107326635794299429788070,
             -0.613371432700590397308702039341,
             -0.324253423403808929038538014644, 
              0,
              0.324253423403808929038538014644, 
              0.613371432700590397308702039341,
              0.836031107326635794299429788070, 
              0.968160239507626089835576202904 };
      Weights = { 0.0812743883615744119718921581134,
                  0.180648160694857404058472031240,
                  0.260610696402935462318742869422,
                  0.312347077040002840068630406582,
                  0.330239355001259763164525069284, 
                  0.312347077040002840068630406582,
                  0.260610696402935462318742869422, 
                  0.180648160694857404058472031240,
                  0.0812743883615744119718921581134 };
      break;
    case QuadratureFormula_type::Gauss10Line:
      Xi = { -0.973906528517171720077964012084, 
             -0.865063366688984510732096688423, 
             -0.679409568299024406234327365115, 
             -0.433395394129247190799265943166, 
             -0.148874338981631210884826001130, 
              0.148874338981631210884826001130, 
              0.433395394129247190799265943166, 
              0.679409568299024406234327365115, 
              0.865063366688984510732096688423, 
              0.973906528517171720077964012084 }; 
      Weights = { 0.066671344308688137593568809893, 
                  0.149451349150580593145776339658, 
                  0.219086362515982043995534934228, 
                  0.269266719309996355091226921569, 
                  0.295524224714752870173892994651, 
                  0.295524224714752870173892994651, 
                  0.269266719309996355091226921569, 
                  0.219086362515982043995534934228, 
                  0.149451349150580593145776339658, 
                  0.066671344308688137593568809893 };
      break;
    case QuadratureFormula_type::Gauss11Line:
      Xi = { -0.978228658146056992803938001123, 
             -0.887062599768095299075157769304, 
             -0.730152005574049324093416252031, 
             -0.519096129206811815925725669459, 
             -0.269543155952344972331531985401, 
              0., 
              0.269543155952344972331531985401, 
              0.519096129206811815925725669459, 
              0.730152005574049324093416252031, 
              0.887062599768095299075157769304, 
              0.978228658146056992803938001123 }; 
      Weights = { 0.055668567116173666482753720443, 
                  0.125580369464904624634694299224, 
                  0.186290210927734251426097641432, 
                  0.233193764591990479918523704843, 
                  0.262804544510246662180688869891, 
                  0.272925086777900630714483528336, 
                  0.262804544510246662180688869891, 
                  0.233193764591990479918523704843, 
                  0.186290210927734251426097641432, 
                  0.125580369464904624634694299224, 
                  0.055668567116173666482753720443 };
      break;
    case QuadratureFormula_type::Gauss12Line:
      Xi = { -0.981560634246719250690549090149, 
             -0.904117256370474856678465866119, 
             -0.769902674194304687036893833213, 
             -0.587317954286617447296702418941, 
             -0.367831498998180193752691536644, 
             -0.125233408511468915472441369464, 
              0.125233408511468915472441369464, 
              0.367831498998180193752691536644, 
              0.587317954286617447296702418941, 
              0.769902674194304687036893833213, 
              0.904117256370474856678465866119, 
              0.981560634246719250690549090149 }; 
      Weights = { 0.047175336386511827194615961485, 
                  0.106939325995318430960254718194, 
                  0.160078328543346226334652529543, 
                  0.203167426723065921749064455810, 
                  0.233492536538354808760849898925, 
                  0.249147045813402785000562436043, 
                  0.249147045813402785000562436043, 
                  0.233492536538354808760849898925, 
                  0.203167426723065921749064455810, 
                  0.160078328543346226334652529543, 
                  0.106939325995318430960254718194, 
                  0.047175336386511827194615961485 };
      break;
    case QuadratureFormula_type::Gauss2W1Line:
      Xi = { 0.112008806166976, 0.602276908118738 }; 
      Weights = { 0.718539319030384, 0.281460680969615 };
      break;
    case QuadratureFormula_type::Gauss4W1Line:
      Xi = { 0.041448480199383,
             0.245474914320602,
             0.556165453560278,
             0.848982394532985 };
      Weights = { 0.383464068145135,
                  0.386875317774762,
                  0.190435126950142,
                  0.039225487129960 };
      break;
    case QuadratureFormula_type::Gauss6W1Line:
      Xi = { 0.021634005844117,
             0.129583391154950,
             0.314020449914765,
             0.538657217351802,
             0.756915337377402,
             0.922668851372120 }; 
      Weights = { 0.238763662578547,
                  0.308286573273946,
                  0.245317426563210,
                  0.142008756566476,
                  0.055454622324886,
                  0.010168958692932 };
      break;
    case QuadratureFormula_type::Gauss8W1Line:
      Xi = { 0.013320244160892,
             0.079750429013895,
             0.197871029326188,
             0.354153994351909,
             0.529458575234917,
             0.701814529939099,
             0.849379320441106,
             0.953326450056359 }; 
      Weights = { 0.164416604728002,
                  0.237525610023306,
                  0.226841984431919,
                  0.175754079006070,
                  0.112924030246759,
                  0.057872210717782,
                  0.020979073742133,
                  0.003686407104028 };
      break;
    case QuadratureFormula_type::Gauss16W2Line:
      Xi = { -0.977454378379800,
             -0.884983053370117,
             -0.733427080657186,
             -0.545819520468488,
             -0.350717878552550,
             -0.177827326392695,
             -0.053490766072146,
             -0.003242501597297,
              0.003242501597297,
              0.053490766072146,
              0.177827326392695,
              0.350717878552550,
              0.545819520468488,
              0.733427080657186,
              0.884983053370117,
              0.977454378379800 };
      Weights = { -0.058747607229312,
                  -0.141462285496869,
                  -0.237267699094551,
                  -0.359757591592037,
                  -0.538360773482498,
                  -0.857634542273069,
                  -1.737406310900222,
                  -3.930636810068551,
                   3.930636810068551,
                   1.737406310900222,
                   0.857634542273069,
                   0.538360773482498,
                   0.359757591592037,
                   0.237267699094551,
                   0.141462285496869,
                   0.058747607229312 };
      break;
    /////////////////////////////////////////////////////////////////////////////
    case QuadratureFormula_type::BaryCenterTria:
      Weights = {0.5};
      Xi = {1./3.};
      Eta = {1./3.};
      break;
    case QuadratureFormula_type::MidPointTria:
      Weights = {1./6., 1./6., 1./6.};
      Xi = {0.5, 0.5, 0.0};
      Eta = {0.0, 0.5, 0.5};
      break;
    case QuadratureFormula_type::SevenPointTria:
      Weights = { 0.225, 2/30., 2./30., 2./30., 0.025, 0.025, 0.025 };
      Xi = { 1./3., 0.5, 0.5, 0.0, 0.0, 1.0, 0.0 };
      Eta = { 1./3., 0.0, 0.5, 0.5, 0.0, 0.0, 1.0 };
      break;
    case QuadratureFormula_type::Gauss3Tria:
      Weights = { 0.1125,
                  0.0629695902724135762978419727500906,
                  0.0629695902724135762978419727500906,
                  0.0629695902724135762978419727500906,
                  0.0661970763942530903688246939165759,
                  0.0661970763942530903688246939165759,
                  0.0661970763942530903688246939165759 };
      Xi = { 0.333333333333333333333333333333333,
             0.797426985353087322398025276169754,
             0.101286507323456338800987361915123,
             0.101286507323456338800987361915123,
             0.059715871789769820459117580973106,
             0.470142064105115089770441209513447,
             0.470142064105115089770441209513447 };
      Eta = { 0.333333333333333333333333333333333,
              0.101286507323456338800987361915123,
              0.797426985353087322398025276169754,
              0.101286507323456338800987361915123,
              0.470142064105115089770441209513447,
              0.059715871789769820459117580973106,
              0.470142064105115089770441209513447 };
      break;
    case QuadratureFormula_type::VertexTria:
      Weights = { 1./6., 1./6., 1./6. };
      Xi = { 0.0, 1.0, 0.0 };
      Eta = { 0.0, 0.0, 1.0 };
      break;
    case QuadratureFormula_type::Degree8Tria:
      // Weights = { 0.0669407676399161741918307676117709,
      //             0.0439095567912207824018635604112394,
      //             0.0292857176401658921592602923421211,
      //             0.0265306244347803793468998583175327,
      //             1.60583438566812187984002319217607e-10,
      //             0.0669407676399161741918307676117709,
      //             0.0439095567912207824018635604112394,
      //             0.0292857176401658921592602923421211,
      //             0.0265306244347803793468998583175327,
      //             1.60583438566812187984002319217607e-10,
      //             0.0669407676399161741918307676117709,
      //             0.0439095567912207824018635604112394,
      //             0.0292857176401658921592602923421211,
      //             0.0265306244347803793468998583175327,
      //             1.60583438566812187984002319217607e-10
      //            };
      // Xi = { 0.513346920639454149493588964941289,
      //        0.313251210671725306955957434773977,
      //        0.651775303648795707537235440171623,
      //        0.0651019934589391663281047918600097,
      //        0.345792011168269028821402703032657,
      //        0.281041247315110390572737910356218,
      //        0.630621434318956140102957434914989,
      //        0.313477887523733007173578085409864,
      //        0.870165101563563060777479924328995,
      //        3.62316822156926166667912853628633,
      //        0.205611832045435459933673124702493,
      //        0.18446744073709551614,
      //        0.034746808827471285289186474418513,
      //        0.0647329049774977728944152838109953,
      //       -2.968960232737530695500531239318987 };
      // Eta = { 0.281041247315110390572737910356218,
      //         0.630621434318956140102957434914989,
      //         0.313477887523733007173578085409864,
      //         0.870165101563563060777479924328995,
      //         3.62316822156926166667912853628633,
      //         0.205611832045435459933673124702493,
      //         0.056127355009318552941085130311034,
      //         0.034746808827471285289186474418513,
      //         0.0647329049774977728944152838109953,
      //        -2.968960232737530695500531239318987,
      //         0.513346920639454149493588964941289,
      //         0.313251210671725306955957434773977,
      //         0.651775303648795707537235440171623,
      //         0.0651019934589391663281047918600097,
      //         0.345792011168269028821402703032657
      //       };
      Output::warn("Instead of Degree8Tria the quadrature rule Degree9Tria is "
          "used, since in the former the points lie outside the domain.");
      // break;
      [[fallthrough]];
    case QuadratureFormula_type::Degree9Tria:
      Weights = { 0.0485678981413994169096209912536443,
                  0.0156673501135695352684274156436046,
                  0.0156673501135695352684274156436046,
                  0.0156673501135695352684274156436046,
                  0.0389137705023871396583696781497019,
                  0.0389137705023871396583696781497019,
                  0.0389137705023871396583696781497019,
                  0.0398238694636051265164458871320226,
                  0.0398238694636051265164458871320226,
                  0.0398238694636051265164458871320226,
                  0.0127888378293490156308393992794999,
                  0.0127888378293490156308393992794999,
                  0.0127888378293490156308393992794999,
                  0.0216417696886446886446886446886446,
                  0.0216417696886446886446886446886446,
                  0.0216417696886446886446886446886446,
                  0.0216417696886446886446886446886446,
                  0.0216417696886446886446886446886446,
                  0.0216417696886446886446886446886446
                };
      Xi = { 0.333333333333333333333333333333333,
             0.489682519198737627783706924836192,
             0.489682519198737627783706924836192,
             0.020634961602524744432586150327616,
             0.437089591492936637269930364435354,
             0.437089591492936637269930364435354,
             0.125820817014126725460139271129292,
             0.188203535619032730240961280467335,
             0.188203535619032730240961280467335,
             0.623592928761934539518077439065330,
             0.0447295133944527098651065899662763,
             0.0447295133944527098651065899662763,
             0.910540973211094580269786820067447,
             0.741198598784498020690079873523423,
             0.0368384120547362836348175987833851,
             0.741198598784498020690079873523423,
             0.221962989160765695675102527693192,
             0.0368384120547362836348175987833851,
             0.221962989160765695675102527693192
           };
      Eta = { 0.333333333333333333333333333333333,
              0.489682519198737627783706924836192,
              0.020634961602524744432586150327616,
              0.489682519198737627783706924836192,
              0.437089591492936637269930364435354,
              0.125820817014126725460139271129292,
              0.437089591492936637269930364435354,
              0.188203535619032730240961280467335,
              0.623592928761934539518077439065330,
              0.188203535619032730240961280467335,
              0.0447295133944527098651065899662763,
              0.910540973211094580269786820067447,
              0.0447295133944527098651065899662763,
              0.0368384120547362836348175987833851,
              0.741198598784498020690079873523423,
              0.221962989160765695675102527693192,
              0.741198598784498020690079873523423,
              0.221962989160765695675102527693192,
              0.0368384120547362836348175987833851
            };
      break;
    case QuadratureFormula_type::Degree11Tria:
      Weights = {
        6.82986550133893097935968864728942e-3,
        6.82986550133893097935968864728942e-3,
        6.82986550133893097935968864728942e-3,
        0.0180922702517090396691439677721401,
        0.0180922702517090396691439677721401,
        0.0180922702517090396691439677721401,
        4.63503164480338025330042487596786e-4,
        4.63503164480338025330042487596786e-4,
        4.63503164480338025330042487596786e-4,
        0.0296614886903870365579061947507576,
        0.0296614886903870365579061947507576,
        0.0296614886903870365579061947507576,
        0.0385747674574065614307555344183042,
        0.0385747674574065614307555344183042,
        0.0385747674574065614307555344183042,
        0.0261685559811020355585694685067805,
        0.0261685559811020355585694685067805,
        0.0261685559811020355585694685067805,
        0.0261685559811020355585694685067805,
        0.0261685559811020355585694685067805,
        0.0261685559811020355585694685067805,
        0.0103538298195703444435161507885086,
        0.0103538298195703444435161507885086,
        0.0103538298195703444435161507885086,
        0.0103538298195703444435161507885086,
        0.0103538298195703444435161507885086,
        0.0103538298195703444435161507885086,
      };
      Xi = {
        0.0323649481112758931588480911328593,
        0.0323649481112758931588480911328593,
        0.9352701037774482136823038177342814,
        0.119350912282581309581102091581736,
        0.119350912282581309581102091581736,
        0.761298175434837380837795816836528,
        0.534611048270758309358680864963778,
        0.534611048270758309358680864963778,
       -0.069222096541516618717361729927556,
        0.203309900431282473351326588944569,
        0.203309900431282473351326588944569,
        0.593380199137435053297346822110862,
        0.398969302965855222611381867187058,
        0.398969302965855222611381867187058,
        0.202061394068289554777236265625884,
        0.593201213428212752488840882179699,
        0.0501781383104946650738269077613887,
        0.3566206482612925824373322100589123,
        0.593201213428212752488840882179699,
        0.0501781383104946650738269077613887,
        0.3566206482612925824373322100589123,
        0.807489003159792153166724890348745,
        0.0210220165361662971236385570923633,
        0.1714889803040415497096365525588917,
        0.807489003159792153166724890348745,
        0.0210220165361662971236385570923633,
        0.1714889803040415497096365525588917
      };
      Eta = {
        0.0323649481112758931588480911328593,
        0.9352701037774482136823038177342814,
        0.0323649481112758931588480911328593,
        0.119350912282581309581102091581736,
        0.761298175434837380837795816836528,
        0.119350912282581309581102091581736,
        0.534611048270758309358680864963778,
       -0.069222096541516618717361729927556,
        0.534611048270758309358680864963778,
        0.203309900431282473351326588944569,
        0.593380199137435053297346822110862,
        0.203309900431282473351326588944569,
        0.398969302965855222611381867187058,
        0.202061394068289554777236265625884,
        0.398969302965855222611381867187058,
        0.0501781383104946650738269077613887,
        0.3566206482612925824373322100589123,
        0.593201213428212752488840882179699,
        0.3566206482612925824373322100589123,
        0.593201213428212752488840882179699,
        0.0501781383104946650738269077613887,
        0.0210220165361662971236385570923633,
        0.1714889803040415497096365525588917,
        0.807489003159792153166724890348745,
        0.1714889803040415497096365525588917,
        0.807489003159792153166724890348745,
        0.0210220165361662971236385570923633,
      };
      break;
    case QuadratureFormula_type::Degree19Tria:
      Weights = { 
        0.0164531656944595,
        0.005165365945636,  0.005165365945636,  0.005165365945636,
        0.011193623631508,  0.011193623631508,  0.011193623631508,
        0.015133062934734,  0.015133062934734,  0.015133062934734,
        0.015245483901099,  0.015245483901099,  0.015245483901099,
        0.0120796063708205, 0.0120796063708205, 0.0120796063708205,
        0.0080254017934005, 0.0080254017934005, 0.0080254017934005,
        0.004042290130892,  0.004042290130892,  0.004042290130892,
        0.0010396810137425, 0.0010396810137425, 0.0010396810137425,
        0.0019424384524905, 0.0019424384524905, 0.0019424384524905,
        0.0019424384524905, 0.0019424384524905, 0.0019424384524905,
        0.012787080306011,  0.012787080306011,  0.012787080306011,
        0.012787080306011,  0.012787080306011,  0.012787080306011,
        0.004440451786669,  0.004440451786669,  0.004440451786669,
        0.004440451786669,  0.004440451786669,  0.004440451786669,
        0.0080622733808655, 0.0080622733808655, 0.0080622733808655,
        0.0080622733808655, 0.0080622733808655, 0.0080622733808655,
        0.0012459709087455, 0.0012459709087455, 0.0012459709087455,
        0.0012459709087455, 0.0012459709087455, 0.0012459709087455,
        0.0091214200594755, 0.0091214200594755, 0.0091214200594755,
        0.0091214200594755, 0.0091214200594755, 0.0091214200594755,
        0.0051292818680995, 0.0051292818680995, 0.0051292818680995,
        0.0051292818680995, 0.0051292818680995, 0.0051292818680995,
        0.001899964427651,  0.001899964427651,  0.001899964427651,
        0.001899964427651,  0.001899964427651,  0.001899964427651000 };
      Xi = {
        0.3333333333333333333333,
        0.020780025853987, 0.489609987073006, 0.489609987073006,
        0.090926214604215, 0.454536892697893, 0.454536892697893,
        0.197166638701138, 0.401416680649431, 0.401416680649431,
        0.488896691193805, 0.255551654403098, 0.255551654403098,
        0.645844115695741, 0.177077942152130, 0.177077942152130,
        0.779877893544096, 0.110061053227952, 0.110061053227952,
        0.888942751496321, 0.055528624251840, 0.055528624251840,
        0.974756272445543, 0.012621863777229, 0.012621863777229,
        0.003611417848412, 0.003611417848412, 0.395754787356943,
        0.395754787356943, 0.600633794794645, 0.600633794794645,
        0.134466754530780, 0.134466754530780, 0.307929983880436,
        0.307929983880436, 0.557603261588784, 0.557603261588784,
        0.014446025776115, 0.014446025776115, 0.264566948406520,
        0.264566948406520, 0.720987025817365, 0.720987025817365,
        0.046933578838178, 0.046933578838178, 0.358539352205951,
        0.358539352205951, 0.594527068955871, 0.594527068955871,
        0.002861120350567, 0.002861120350567, 0.157807405968595,
        0.157807405968595, 0.839331473680839, 0.839331473680839,
        0.223861424097916, 0.223861424097916, 0.075050596975911,
        0.075050596975911, 0.701087978926173, 0.701087978926173,
        0.034647074816760, 0.034647074816760, 0.142421601113383,
        0.142421601113383, 0.822931324069857, 0.822931324069857,
        0.010161119296278, 0.010161119296278, 0.065494628082938,
        0.065494628082938, 0.924344252620784, 0.924344252620784 };
      Eta = {
        0.3333333333333333333333,
        0.489609987073006, 0.020780025853987, 0.489609987073006,
        0.454536892697893, 0.090926214604215, 0.454536892697893,
        0.401416680649431, 0.197166638701138, 0.401416680649431,
        0.255551654403098, 0.488896691193805, 0.255551654403098,
        0.177077942152130, 0.645844115695741, 0.177077942152130,
        0.110061053227952, 0.779877893544096, 0.110061053227952,
        0.055528624251840, 0.888942751496321, 0.055528624251840,
        0.012621863777229, 0.974756272445543, 0.012621863777229,
        0.395754787356943, 0.600633794794645, 0.003611417848412,
        0.600633794794645, 0.003611417848412, 0.395754787356943,
        0.307929983880436, 0.557603261588784, 0.134466754530780,
        0.557603261588784, 0.134466754530780, 0.307929983880436,
        0.264566948406520, 0.720987025817365, 0.014446025776115,
        0.720987025817365, 0.014446025776115, 0.264566948406520,
        0.358539352205951, 0.594527068955871, 0.046933578838178,
        0.594527068955871, 0.046933578838178, 0.358539352205951,
        0.157807405968595, 0.839331473680839, 0.002861120350567,
        0.839331473680839, 0.002861120350567, 0.157807405968595,
        0.075050596975911, 0.701087978926173, 0.223861424097916,
        0.701087978926173, 0.223861424097916, 0.075050596975911,
        0.142421601113383, 0.822931324069857, 0.034647074816760,
        0.822931324069857, 0.034647074816760, 0.142421601113383,
        0.065494628082938, 0.924344252620784, 0.010161119296278,
        0.924344252620784, 0.010161119296278, 0.065494628082938 };
      break;
    case QuadratureFormula_type::Gauss2Quad:
      Weights = { 1, 1, 1, 1 };
      Xi = { -0.57735026918962576450914878050195746,
              0.57735026918962576450914878050195746,
             -0.57735026918962576450914878050195746,
              0.57735026918962576450914878050195746 };
      Eta = { -0.57735026918962576450914878050195746,
              -0.57735026918962576450914878050195746,
               0.57735026918962576450914878050195746,
               0.57735026918962576450914878050195746 };
      break;
    case QuadratureFormula_type::Gauss3Quad:
      Weights = { 0.30864197530864197530864197530864198,
                  0.49382716049382716049382716049382717,
                  0.30864197530864197530864197530864198,
                  0.49382716049382716049382716049382717,
                  0.79012345679012345679012345679012346,
                  0.49382716049382716049382716049382717,
                  0.30864197530864197530864197530864198,
                  0.49382716049382716049382716049382717,
                  0.30864197530864197530864197530864198 };
      Xi = { -0.77459666924148337703585307995647992,
              0.,
              0.77459666924148337703585307995647992,
             -0.77459666924148337703585307995647992,
              0.,
              0.77459666924148337703585307995647992,
             -0.77459666924148337703585307995647992,
              0.,
              0.77459666924148337703585307995647992 };
      Eta = { -0.77459666924148337703585307995647992,
              -0.77459666924148337703585307995647992,
              -0.77459666924148337703585307995647992,
               0.,
               0.,
               0.,
               0.77459666924148337703585307995647992,
               0.77459666924148337703585307995647992,
               0.77459666924148337703585307995647992 };
      break;
    case QuadratureFormula_type::Gauss4Quad:
      Weights = {
        0.12100299328560200552121209737014755,
        0.22685185185185185185185185185185185,
        0.22685185185185185185185185185185185,
        0.12100299328560200552121209737014755,
        0.22685185185185185185185185185185185,
        0.42529330301069429077508419892614875,
        0.42529330301069429077508419892614875,
        0.22685185185185185185185185185185185,
        0.22685185185185185185185185185185185,
        0.42529330301069429077508419892614875,
        0.42529330301069429077508419892614875,
        0.22685185185185185185185185185185185,
        0.12100299328560200552121209737014755,
        0.22685185185185185185185185185185185,
        0.22685185185185185185185185185185185,
        0.12100299328560200552121209737014755 };
      Xi = {
       -0.86113631159405257522394648889280951,
       -0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.86113631159405257522394648889280951,
       -0.86113631159405257522394648889280951,
       -0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.86113631159405257522394648889280951,
       -0.86113631159405257522394648889280951,
       -0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.86113631159405257522394648889280951,
       -0.86113631159405257522394648889280951,
       -0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.86113631159405257522394648889280951 };
      Eta = {
       -0.86113631159405257522394648889280951,
       -0.86113631159405257522394648889280951,
       -0.86113631159405257522394648889280951,
       -0.86113631159405257522394648889280951,
       -0.33998104358485626480266575910324469,
       -0.33998104358485626480266575910324469,
       -0.33998104358485626480266575910324469,
       -0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.33998104358485626480266575910324469,
        0.86113631159405257522394648889280951,
        0.86113631159405257522394648889280951,
        0.86113631159405257522394648889280951,
        0.86113631159405257522394648889280951 };
      break;
    case QuadratureFormula_type::Gauss5Quad:
      Weights = {
        0.056134348862428635954651158026251974,
        0.11340000000000000000000000000000000,
        0.13478507238752090311922576538733075,
        0.11340000000000000000000000000000000,
        0.056134348862428635954651158026251974,
        0.11340000000000000000000000000000000,
        0.22908540422399111713176859506016780,
        0.27228653255075070181904583955094084,
        0.22908540422399111713176859506016780,
        0.11340000000000000000000000000000000,
        0.13478507238752090311922576538733075,
        0.27228653255075070181904583955094084,
        0.32363456790123456790123456790123452,
        0.27228653255075070181904583955094084,
        0.13478507238752090311922576538733075,
        0.11340000000000000000000000000000000,
        0.22908540422399111713176859506016780,
        0.27228653255075070181904583955094084,
        0.22908540422399111713176859506016780,
        0.11340000000000000000000000000000000,
        0.056134348862428635954651158026251974,
        0.11340000000000000000000000000000000,
        0.13478507238752090311922576538733075,
        0.11340000000000000000000000000000000,
        0.056134348862428635954651158026251974 };
      Xi = {
       -0.90617984593866399279762687829939297,
       -0.53846931010568309103631442070020880,
        0.,
        0.53846931010568309103631442070020880,
        0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.53846931010568309103631442070020880,
        0.,
        0.53846931010568309103631442070020880,
        0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.53846931010568309103631442070020880,
        0.,
        0.53846931010568309103631442070020880,
        0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.53846931010568309103631442070020880,
        0.,
        0.53846931010568309103631442070020880,
        0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.53846931010568309103631442070020880,
        0.,
        0.53846931010568309103631442070020880,
        0.90617984593866399279762687829939297 };
      Eta = {
       -0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.90617984593866399279762687829939297,
       -0.53846931010568309103631442070020880,
       -0.53846931010568309103631442070020880,
       -0.53846931010568309103631442070020880,
       -0.53846931010568309103631442070020880,
       -0.53846931010568309103631442070020880,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.53846931010568309103631442070020880,
        0.53846931010568309103631442070020880,
        0.53846931010568309103631442070020880,
        0.53846931010568309103631442070020880,
        0.53846931010568309103631442070020880,
        0.90617984593866399279762687829939297,
        0.90617984593866399279762687829939297,
        0.90617984593866399279762687829939297,
        0.90617984593866399279762687829939297,
        0.90617984593866399279762687829939297 };
      break;
    case QuadratureFormula_type::Gauss6Quad:
      Weights = {
        0.029352081688980397634757062732583707,
        0.061807293372383328617431798360901623,
        0.080165117317806618788107281079247560,
        0.080165117317806618788107281079247560,
        0.061807293372383328617431798360901623,
        0.029352081688980397634757062732583707,
        0.061807293372383328617431798360901623,
        0.13014891258816744858016301713918589,
        0.16880536708758783037223869833762859,
        0.16880536708758783037223869833762859,
        0.13014891258816744858016301713918589,
        0.061807293372383328617431798360901623,
        0.080165117317806618788107281079247560,
        0.16880536708758783037223869833762859,
        0.21894345016729659822952436457267485,
        0.21894345016729659822952436457267485,
        0.16880536708758783037223869833762859,
        0.080165117317806618788107281079247560,
        0.080165117317806618788107281079247560,
        0.16880536708758783037223869833762859,
        0.21894345016729659822952436457267485,
        0.21894345016729659822952436457267485,
        0.16880536708758783037223869833762859,
        0.080165117317806618788107281079247560,
        0.061807293372383328617431798360901623,
        0.13014891258816744858016301713918589,
        0.16880536708758783037223869833762859,
        0.16880536708758783037223869833762859,
        0.13014891258816744858016301713918589,
        0.061807293372383328617431798360901623,
        0.029352081688980397634757062732583707,
        0.061807293372383328617431798360901623,
        0.080165117317806618788107281079247560,
        0.080165117317806618788107281079247560,
        0.061807293372383328617431798360901623,
        0.029352081688980397634757062732583707 };
      Xi = {
       -0.93246951420315202781230155449399461,
       -0.66120938646626451366139959501990535,
       -0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.66120938646626451366139959501990535,
        0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.66120938646626451366139959501990535,
       -0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.66120938646626451366139959501990535,
        0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.66120938646626451366139959501990535,
       -0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.66120938646626451366139959501990535,
        0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.66120938646626451366139959501990535,
       -0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.66120938646626451366139959501990535,
        0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.66120938646626451366139959501990535,
       -0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.66120938646626451366139959501990535,
        0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.66120938646626451366139959501990535,
       -0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.66120938646626451366139959501990535,
        0.93246951420315202781230155449399461 };
      Eta = {
       -0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.93246951420315202781230155449399461,
       -0.66120938646626451366139959501990535,
       -0.66120938646626451366139959501990535,
       -0.66120938646626451366139959501990535,
       -0.66120938646626451366139959501990535,
       -0.66120938646626451366139959501990535,
       -0.66120938646626451366139959501990535,
       -0.23861918608319690863050172168071194,
       -0.23861918608319690863050172168071194,
       -0.23861918608319690863050172168071194,
       -0.23861918608319690863050172168071194,
       -0.23861918608319690863050172168071194,
       -0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.23861918608319690863050172168071194,
        0.66120938646626451366139959501990535,
        0.66120938646626451366139959501990535,
        0.66120938646626451366139959501990535,
        0.66120938646626451366139959501990535,
        0.66120938646626451366139959501990535,
        0.66120938646626451366139959501990535,
        0.93246951420315202781230155449399461,
        0.93246951420315202781230155449399461,
        0.93246951420315202781230155449399461,
        0.93246951420315202781230155449399461,
        0.93246951420315202781230155449399461,
        0.93246951420315202781230155449399461 };
      break;
    case QuadratureFormula_type::Gauss7Quad:
      Weights = {
        0.016766356463753329011668073624634837,
        0.036217643154239442374745286152464361,
        0.049441251171913132923156010235986909,
        0.054119430757927577922084125331991827,
        0.049441251171913132923156010235986909,
        0.036217643154239442374745286152464361,
        0.016766356463753329011668073624634837,
        0.036217643154239442374745286152464361,
        0.078235106028169524644506042712736971,
        0.10679992375890457681464440216307820,
        0.11690543709592624813514408079100011,
        0.10679992375890457681464440216307820,
        0.078235106028169524644506042712736971,
        0.036217643154239442374745286152464361,
        0.049441251171913132923156010235986909,
        0.10679992375890457681464440216307820,
        0.14579418746874168426783902633466301,
        0.15958937621111910188946067351049409,
        0.14579418746874168426783902633466301,
        0.10679992375890457681464440216307820,
        0.049441251171913132923156010235986909,
        0.054119430757927577922084125331991827,
        0.11690543709592624813514408079100011,
        0.15958937621111910188946067351049409,
        0.17468987921699291961682632236568093,
        0.15958937621111910188946067351049409,
        0.11690543709592624813514408079100011,
        0.054119430757927577922084125331991827,
        0.049441251171913132923156010235986909,
        0.10679992375890457681464440216307820,
        0.14579418746874168426783902633466301,
        0.15958937621111910188946067351049409,
        0.14579418746874168426783902633466301,
        0.10679992375890457681464440216307820,
        0.049441251171913132923156010235986909,
        0.036217643154239442374745286152464361,
        0.078235106028169524644506042712736971,
        0.10679992375890457681464440216307820,
        0.11690543709592624813514408079100011,
        0.10679992375890457681464440216307820,
        0.078235106028169524644506042712736971,
        0.036217643154239442374745286152464361,
        0.016766356463753329011668073624634837,
        0.036217643154239442374745286152464361,
        0.049441251171913132923156010235986909,
        0.054119430757927577922084125331991827,
        0.049441251171913132923156010235986909,
        0.036217643154239442374745286152464361,
        0.016766356463753329011668073624634837 };
      Xi = {
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
        0.,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
        0.,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
        0.,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
        0.,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
        0.,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
        0.,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
        0.,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126 };
      Eta = {
       -0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.94910791234275852452618968404785126,
       -0.74153118559939443986386477328078841,
       -0.74153118559939443986386477328078841,
       -0.74153118559939443986386477328078841,
       -0.74153118559939443986386477328078841,
       -0.74153118559939443986386477328078841,
       -0.74153118559939443986386477328078841,
       -0.74153118559939443986386477328078841,
       -0.40584515137739716690660641207696146,
       -0.40584515137739716690660641207696146,
       -0.40584515137739716690660641207696146,
       -0.40584515137739716690660641207696146,
       -0.40584515137739716690660641207696146,
       -0.40584515137739716690660641207696146,
       -0.40584515137739716690660641207696146,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.40584515137739716690660641207696146,
        0.40584515137739716690660641207696146,
        0.40584515137739716690660641207696146,
        0.40584515137739716690660641207696146,
        0.40584515137739716690660641207696146,
        0.40584515137739716690660641207696146,
        0.40584515137739716690660641207696146,
        0.74153118559939443986386477328078841,
        0.74153118559939443986386477328078841,
        0.74153118559939443986386477328078841,
        0.74153118559939443986386477328078841,
        0.74153118559939443986386477328078841,
        0.74153118559939443986386477328078841,
        0.74153118559939443986386477328078841,
        0.94910791234275852452618968404785126,
        0.94910791234275852452618968404785126,
        0.94910791234275852452618968404785126,
        0.94910791234275852452618968404785126,
        0.94910791234275852452618968404785126,
        0.94910791234275852452618968404785126,
        0.94910791234275852452618968404785126 };
      break;
    case QuadratureFormula_type::Gauss8Quad:
      Weights = {
        0.010247216559492023290653071261207573,
        0.022511306616454830804021349419391882,
        0.031756064586781927171542031803085337,
        0.036713948527647477886314901826277389,
        0.036713948527647477886314901826277389,
        0.031756064586781927171542031803085337,
        0.022511306616454830804021349419391882,
        0.010247216559492023290653071261207573,
        0.022511306616454830804021349419391882,
        0.049453324484552923303261268350586497,
        0.069762408425222997174804068722261515,
        0.080653994927143719262269307934001006,
        0.080653994927143719262269307934001006,
        0.069762408425222997174804068722261515,
        0.049453324484552923303261268350586497,
        0.022511306616454830804021349419391882,
        0.031756064586781927171542031803085337,
        0.069762408425222997174804068722261515,
        0.098411859667954176968572296313663868,
        0.11377631319792818602304380514759058,
        0.11377631319792818602304380514759058,
        0.098411859667954176968572296313663868,
        0.069762408425222997174804068722261515,
        0.031756064586781927171542031803085337,
        0.036713948527647477886314901826277389,
        0.080653994927143719262269307934001006,
        0.11377631319792818602304380514759058,
        0.13153952672564259979352243436932664,
        0.13153952672564259979352243436932664,
        0.11377631319792818602304380514759058,
        0.080653994927143719262269307934001006,
        0.036713948527647477886314901826277389,
        0.036713948527647477886314901826277389,
        0.080653994927143719262269307934001006,
        0.11377631319792818602304380514759058,
        0.13153952672564259979352243436932664,
        0.13153952672564259979352243436932664,
        0.11377631319792818602304380514759058,
        0.080653994927143719262269307934001006,
        0.036713948527647477886314901826277389,
        0.031756064586781927171542031803085337,
        0.069762408425222997174804068722261515,
        0.098411859667954176968572296313663868,
        0.11377631319792818602304380514759058,
        0.11377631319792818602304380514759058,
        0.098411859667954176968572296313663868,
        0.069762408425222997174804068722261515,
        0.031756064586781927171542031803085337,
        0.022511306616454830804021349419391882,
        0.049453324484552923303261268350586497,
        0.069762408425222997174804068722261515,
        0.080653994927143719262269307934001006,
        0.080653994927143719262269307934001006,
        0.069762408425222997174804068722261515,
        0.049453324484552923303261268350586497,
        0.022511306616454830804021349419391882,
        0.010247216559492023290653071261207573,
        0.022511306616454830804021349419391882,
        0.031756064586781927171542031803085337,
        0.036713948527647477886314901826277389,
        0.036713948527647477886314901826277389,
        0.031756064586781927171542031803085337,
        0.022511306616454830804021349419391882,
        0.010247216559492023290653071261207573 };
      Xi = {
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299 };
      Eta = {
       -0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.96028985649753623168356086856947299,
       -0.79666647741362673959155393647583044,
       -0.79666647741362673959155393647583044,
       -0.79666647741362673959155393647583044,
       -0.79666647741362673959155393647583044,
       -0.79666647741362673959155393647583044,
       -0.79666647741362673959155393647583044,
       -0.79666647741362673959155393647583044,
       -0.79666647741362673959155393647583044,
       -0.52553240991632898581773904918924635,
       -0.52553240991632898581773904918924635,
       -0.52553240991632898581773904918924635,
       -0.52553240991632898581773904918924635,
       -0.52553240991632898581773904918924635,
       -0.52553240991632898581773904918924635,
       -0.52553240991632898581773904918924635,
       -0.52553240991632898581773904918924635,
       -0.18343464249564980493947614236018398,
       -0.18343464249564980493947614236018398,
       -0.18343464249564980493947614236018398,
       -0.18343464249564980493947614236018398,
       -0.18343464249564980493947614236018398,
       -0.18343464249564980493947614236018398,
       -0.18343464249564980493947614236018398,
       -0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.18343464249564980493947614236018398,
        0.52553240991632898581773904918924635,
        0.52553240991632898581773904918924635,
        0.52553240991632898581773904918924635,
        0.52553240991632898581773904918924635,
        0.52553240991632898581773904918924635,
        0.52553240991632898581773904918924635,
        0.52553240991632898581773904918924635,
        0.52553240991632898581773904918924635,
        0.79666647741362673959155393647583044,
        0.79666647741362673959155393647583044,
        0.79666647741362673959155393647583044,
        0.79666647741362673959155393647583044,
        0.79666647741362673959155393647583044,
        0.79666647741362673959155393647583044,
        0.79666647741362673959155393647583044,
        0.79666647741362673959155393647583044,
        0.96028985649753623168356086856947299,
        0.96028985649753623168356086856947299,
        0.96028985649753623168356086856947299,
        0.96028985649753623168356086856947299,
        0.96028985649753623168356086856947299,
        0.96028985649753623168356086856947299,
        0.96028985649753623168356086856947299,
        0.96028985649753623168356086856947299 };
      break;
    case QuadratureFormula_type::Gauss9Quad:
      Weights = {
        0.0066055262035480222296868720976836826,
        0.014682068769117942739167977912237288,
        0.021180974950632540408929588254010875,
        0.025385817642951793056718139413406420,
        0.026840001590648227074779160866370759,
        0.025385817642951793056718139413406420,
        0.021180974950632540408929588254010875,
        0.014682068769117942739167977912237288,
        0.0066055262035480222296868720976836826,
        0.014682068769117942739167977912237288,
        0.032633757962435023493905821685868092,
        0.047078842962596181839044542982247493,
        0.056424924965691438570440302319562887,
        0.059657132070033634831826772685994122,
        0.056424924965691438570440302319562887,
        0.047078842962596181839044542982247493,
        0.032633757962435023493905821685868092,
        0.014682068769117942739167977912237288,
        0.021180974950632540408929588254010875,
        0.047078842962596181839044542982247493,
        0.067917935079622998718295692882473094,
        0.081400989266816473883283998461353834,
        0.086063908286534534938378093677095088,
        0.081400989266816473883283998461353834,
        0.067917935079622998718295692882473094,
        0.047078842962596181839044542982247493,
        0.021180974950632540408929588254010875,
        0.025385817642951793056718139413406420,
        0.056424924965691438570440302319562887,
        0.081400989266816473883283998461353834,
        0.097560696535433469335870600993501503,
        0.10314929725821933044463473079323809,
        0.097560696535433469335870600993501503,
        0.081400989266816473883283998461353834,
        0.056424924965691438570440302319562887,
        0.025385817642951793056718139413406420,
        0.026840001590648227074779160866370759,
        0.059657132070033634831826772685994122,
        0.086063908286534534938378093677095088,
        0.10314929725821933044463473079323809,
        0.10905803159164807174981262252855191,
        0.10314929725821933044463473079323809,
        0.086063908286534534938378093677095088,
        0.059657132070033634831826772685994122,
        0.026840001590648227074779160866370759,
        0.025385817642951793056718139413406420,
        0.056424924965691438570440302319562887,
        0.081400989266816473883283998461353834,
        0.097560696535433469335870600993501503,
        0.10314929725821933044463473079323809,
        0.097560696535433469335870600993501503,
        0.081400989266816473883283998461353834,
        0.056424924965691438570440302319562887,
        0.025385817642951793056718139413406420,
        0.021180974950632540408929588254010875,
        0.047078842962596181839044542982247493,
        0.067917935079622998718295692882473094,
        0.081400989266816473883283998461353834,
        0.086063908286534534938378093677095088,
        0.081400989266816473883283998461353834,
        0.067917935079622998718295692882473094,
        0.047078842962596181839044542982247493,
        0.021180974950632540408929588254010875,
        0.014682068769117942739167977912237288,
        0.032633757962435023493905821685868092,
        0.047078842962596181839044542982247493,
        0.056424924965691438570440302319562887,
        0.059657132070033634831826772685994122,
        0.056424924965691438570440302319562887,
        0.047078842962596181839044542982247493,
        0.032633757962435023493905821685868092,
        0.014682068769117942739167977912237288,
        0.0066055262035480222296868720976836826,
        0.014682068769117942739167977912237288,
        0.021180974950632540408929588254010875,
        0.025385817642951793056718139413406420,
        0.026840001590648227074779160866370759,
        0.025385817642951793056718139413406420,
        0.021180974950632540408929588254010875,
        0.014682068769117942739167977912237288,
        0.0066055262035480222296868720976836826 };
      Xi = {
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
        0.,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287 };
      Eta = {
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.96816023950762608983557620290367287,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.83603110732663579429942978806973488,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.61337143270059039730870203934147418,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
       -0.32425342340380892903853801464333661,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.32425342340380892903853801464333661,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.61337143270059039730870203934147418,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.83603110732663579429942978806973488,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287,
        0.96816023950762608983557620290367287 };
      break;
    case QuadratureFormula_type::VertexQuad:
      Weights = { 1,  1, 1,  1};
      Xi = {-1,  1, 1, -1};
      Eta = {-1, -1, 1,  1};
      break;
    case QuadratureFormula_type::SimpsonQuad:
      Weights = { 0.11111111111111111111, 0.11111111111111111111,
                0.11111111111111111111, 0.11111111111111111111,
                0.44444444444444444444, 0.44444444444444444444,
                0.44444444444444444444, 0.44444444444444444444,
                1.77777777777777777777 };
      Xi = { -1,  1,  1, -1,  0,  1,  0, -1,  0};
      Eta = { -1, -1,  1,  1, -1,  0,  1,  0,  0};
      break;
    case QuadratureFormula_type::CompGauss3Tria:
      Weights = {
       0.0375,
       0.0209898634241378587659473242500302,
       0.0209898634241378587659473242500302,
       0.0209898634241378587659473242500302,
       0.0220656921314176967896082313055253,
       0.0220656921314176967896082313055253,
       0.0220656921314176967896082313055253,

       0.0375,
       0.0209898634241378587659473242500302,
       0.0209898634241378587659473242500302,
       0.0209898634241378587659473242500302,
       0.0220656921314176967896082313055253,
       0.0220656921314176967896082313055253,
       0.0220656921314176967896082313055253,

       0.0375,
       0.0209898634241378587659473242500302,
       0.0209898634241378587659473242500302,
       0.0209898634241378587659473242500302,
       0.0220656921314176967896082313055253,
       0.0220656921314176967896082313055253,
       0.0220656921314176967896082313055253 };
      Xi = {
       0.444444444444444444444444444444444,
       0.831189154460906101998354396808128,
       0.367095502441152112933662453971708,
       0.135048676431275118401316482553497,
       0.216429893158141517049264650810922,
       0.490047354701705029923480403171149,
       0.626856085473486786360588279351263,

       0.444444444444444444444444444444445,
       0.135048676431275118401316482553497,
       0.367095502441152112933662453971708,
       0.831189154460906101998354396808128,
       0.626856085473486786360588279351263,
       0.490047354701705029923480403171149,
       0.216429893158141517049264650810922,

       0.111111111111111111111111111111111,
       0.0337621691078187796003291206383743,
       0.265808995117695774132675092056585,
       0.0337621691078187796003291206383743,
       0.156714021368371696590147069837816,
       0.0199052905965899401530391936577020,
       0.156714021368371696590147069837816 };
      Eta = {
       0.111111111111111111111111111111111,
       0.0337621691078187796003291206383743,
       0.265808995117695774132675092056585,
       0.0337621691078187796003291206383743,
       0.156714021368371696590147069837816,
       0.0199052905965899401530391936577020,
       0.156714021368371696590147069837816,

       0.444444444444444444444444444444444,
       0.831189154460906101998354396808128,
       0.367095502441152112933662453971708,
       0.135048676431275118401316482553497,
       0.216429893158141517049264650810922,
       0.490047354701705029923480403171149,
       0.626856085473486786360588279351263,

       0.444444444444444444444444444444445,
       0.135048676431275118401316482553497,
       0.367095502441152112933662453971708,
       0.831189154460906101998354396808128,
       0.626856085473486786360588279351263,
       0.490047354701705029923480403171149,
       0.216429893158141517049264650810922 };
      break;
    case QuadratureFormula_type::CompGauss4Tria:
    {
      double w1[7] = { 0.1125, 
                       0.0629695902724135762978419727500906,
                       0.0629695902724135762978419727500906,
                       0.0629695902724135762978419727500906,
                       0.0661970763942530903688246939165759,
                       0.0661970763942530903688246939165759,
                       0.0661970763942530903688246939165759 };

      double x1[7] = { 0.333333333333333333333333333333333,
                       0.797426985353087322398025276169754,
                       0.101286507323456338800987361915123,
                       0.101286507323456338800987361915123,
                       0.059715871789769820459117580973106,
                       0.470142064105115089770441209513447, 
                       0.470142064105115089770441209513447 };

      double e1[7] = { 0.333333333333333333333333333333333,
                       0.101286507323456338800987361915123,
                       0.797426985353087322398025276169754,
                       0.101286507323456338800987361915123,
                       0.470142064105115089770441209513447,
                       0.059715871789769820459117580973106,
                       0.470142064105115089770441209513447 };
      Weights = std::vector<double>(28, 0.);
      Xi = std::vector<double>(28, 0.);
      Eta = std::vector<double>(28, 0.);
      for(int i=0;i<7;i++)
      {
        Weights[i   ] = w1[i]*0.25;
        Weights[i+ 7] = w1[i]*0.25;
        Weights[i+14] = w1[i]*0.25;
        Weights[i+21] = w1[i]*0.25;
      
        Xi[i   ] =     x1[i]*0.5;
        Xi[i+ 7] = 0.5+x1[i]*0.5;
        Xi[i+14] =     x1[i]*0.5;
        Xi[i+21] = 0.5-x1[i]*0.5;
      
        Eta[i   ] =     e1[i]*0.5;
        Eta[i+ 7] =     e1[i]*0.5;
        Eta[i+14] = 0.5+e1[i]*0.5;
        Eta[i+21] = 0.5-e1[i]*0.5;
      }
      break;
    }
    case QuadratureFormula_type::Gauss_Degree8Tria:
      Weights = {  0.0721578038388935028014,
                   0.0475458171336424970100,
                   0.0475458171336424970100,
                   0.0475458171336424970100,
                   0.0516086852673589974172,
                   0.0516086852673589974172,
                   0.0516086852673589974172,
                   0.0162292488115990014841,
                   0.0162292488115990014841,
                   0.0162292488115990014841,
                   0.0136151570872174998428,
                   0.0136151570872174998428,
                   0.0136151570872174998428,
                   0.0136151570872174998428,
                   0.0136151570872174998428,
                   0.0136151570872174998428};
      Xi = { 0.333333333333333333333333333333333,
             0.081414823414554,
             0.459292588292723,
             0.459292588292723,
             0.658861384496480,
             0.170569307751760,
             0.170569307751760,
             0.898905543365938,
             0.050547228317031,
             0.050547228317031,
             0.008394777409958,
             0.263112829634638,
             0.008394777409958,
             0.728492392955404,
             0.263112829634638,
             0.728492392955404 };
      Eta = { 0.333333333333333333333333333333333, 
              0.459292588292723,
              0.081414823414554,
              0.459292588292723,
              0.170569307751760,
              0.658861384496480,
              0.170569307751760,
              0.050547228317031,
              0.898905543365938,
              0.050547228317031,
              0.263112829634638,
              0.008394777409958,
              0.728492392955404,
              0.008394777409958,
              0.728492392955404,
              0.263112829634638};
      break;
    /////////////////////////////////////////////////////////////////////////////
    case QuadratureFormula_type::BaryCenterTetra:
      Weights = {1./6.};
      Xi = {0.25};
      Eta = {0.25};
      Zeta = {0.25};
      break;
    case QuadratureFormula_type::VertexTetra:
      Weights = {1./24., 1./24., 1./24., 1./24.};
      Xi = {0.0, 1.0, 0.0, 0.0};
      Eta = {0.0, 0.0, 1.0, 0.0};
      Zeta = {0.0, 0.0, 0.0, 1.0};
      break;
    case QuadratureFormula_type::P2Tetra:
      Weights = {1./24., 1./24., 1./24., 1./24.};
      Xi = { 0.138196601125010515179541316563,
             0.138196601125010515179541316563,
             0.138196601125010515179541316563,
             0.585410196624968454461376050311 };
      Eta = { 0.138196601125010515179541316563,
              0.138196601125010515179541316563,
              0.585410196624968454461376050311,
              0.138196601125010515179541316563 };
      Zeta = { 0.138196601125010515179541316563,
               0.585410196624968454461376050311,
               0.138196601125010515179541316563,
               0.138196601125010515179541316563 };
      break;
    case QuadratureFormula_type::P4Tetra:
      Weights = { -.0131555555555555555555555555556,
                   .00762222222222222222222222222222,
                   .00762222222222222222222222222222,
                   .00762222222222222222222222222222,
                   .00762222222222222222222222222222,
                   .0248888888888888888888888888889,
                   .0248888888888888888888888888889,
                   .0248888888888888888888888888889,
                   .0248888888888888888888888888889,
                   .0248888888888888888888888888889,
                   .0248888888888888888888888888889 };
      Xi = { .25,
             .0714285714285714285714285714286,
             .785714285714285714285714285714,
             .0714285714285714285714285714286,
             .0714285714285714285714285714286,
             .399403576166799204996102147462,
             .399403576166799204996102147462,
             .100596423833200795003897852538,
             .100596423833200795003897852538,
             .100596423833200795003897852538,
             .399403576166799204996102147462 };
      Eta = { .25,
              .0714285714285714285714285714286,
              .0714285714285714285714285714286,
              .785714285714285714285714285714,
              .0714285714285714285714285714286,
              .399403576166799204996102147462,
              .100596423833200795003897852538,
              .399403576166799204996102147462,
              .100596423833200795003897852538,
              .399403576166799204996102147462,
              .100596423833200795003897852538 };
      Zeta = { .25,
               .0714285714285714285714285714286,
               .0714285714285714285714285714286,
               .0714285714285714285714285714286,
               .785714285714285714285714285714,
               .100596423833200795003897852538,
               .399403576166799204996102147462,
               .399403576166799204996102147462,
               .399403576166799204996102147462,
               .100596423833200795003897852538,
               .100596423833200795003897852538 };
      break;
    case QuadratureFormula_type::P5Tetra:
      Weights = { 0.602678571428571428571428571428571e-2,
                  0.602678571428571428571428571428571e-2,
                  0.602678571428571428571428571428571e-2,
                  0.602678571428571428571428571428571e-2,
                  0.302836780970891758063769725577305e-1,
                  0.116452490860289694108936091443380e-1,
                  0.116452490860289694108936091443380e-1,
                  0.116452490860289694108936091443380e-1,
                  0.116452490860289694108936091443380e-1,
                  0.109491415613864593456430191124068e-1,
                  0.109491415613864593456430191124068e-1,
                  0.109491415613864593456430191124068e-1,
                  0.109491415613864593456430191124068e-1,
                  0.109491415613864593456430191124068e-1,
                  0.109491415613864593456430191124068e-1 };
      Xi = { 0.333333333333333333333333333333333,
             0.333333333333333333333333333333333,
             0,
             0.333333333333333333333333333333333,
             0.25,
             0.909090909090909090909090909090909e-1,
             0.909090909090909090909090909090909e-1,
             0.727272727272727272727272727272727,
             0.909090909090909090909090909090909e-1,
             0.665501535736642982398804642263025e-1,
             0.433449846426335701760119535773697,
             0.433449846426335701760119535773697,
             0.665501535736642982398804642263025e-1,
             0.665501535736642982398804642263025e-1,
             0.433449846426335701760119535773697 };
      Eta = { 0.333333333333333333333333333333333,
              0,
              0.333333333333333333333333333333333,
              0.333333333333333333333333333333333,
              0.25,
              0.909090909090909090909090909090909e-1,
              0.727272727272727272727272727272727,
              0.909090909090909090909090909090909e-1,
              0.909090909090909090909090909090909e-1,
              0.433449846426335701760119535773697,
              0.665501535736642982398804642263025e-1,
              0.433449846426335701760119535773697,
              0.665501535736642982398804642263025e-1,
              0.433449846426335701760119535773697,
              0.665501535736642982398804642263025e-1 };
      Zeta = { 0,
               0.333333333333333333333333333333333,
               0.333333333333333333333333333333333,
               0.333333333333333333333333333333333,
               0.25,
               0.727272727272727272727272727272727,
               0.90909090909090909090909090909091e-1,
               0.909090909090909090909090909090911e-1,
               0.909090909090909090909090909090911e-1,
               0.433449846426335701760119535773699,
               0.433449846426335701760119535773699,
               0.66550153573664298239880464226304e-1,
               0.433449846426335701760119535773699,
               0.66550153573664298239880464226304e-1,
               0.665501535736642982398804642263035e-1 };
      break;
    case QuadratureFormula_type::P8Tetra:
      Weights = { -0.205001886586399158405865177642941e-1,
                   0.142503058228669012484397415358704e-1,
                   0.142503058228669012484397415358704e-1,
                   0.142503058228669012484397415358704e-1,
                   0.142503058228669012484397415358704e-1,
                   0.196703331313390098756280342445466e-2,
                   0.196703331313390098756280342445466e-2,
                   0.196703331313390098756280342445466e-2,
                   0.196703331313390098756280342445466e-2,
                   0.169834109092887379837744566704016e-3,
                   0.169834109092887379837744566704016e-3,
                   0.169834109092887379837744566704016e-3,
                   0.169834109092887379837744566704016e-3,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.457968382446728180074351446297276e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.570448580868191850680255862783040e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2,
                   0.214051914116209259648335300092023e-2 };
      Xi = { 0.25,
             0.206829931610673204083980900024961,
             0.206829931610673204083980900024961,
             0.379510205167980387748057299925117,
             0.206829931610673204083980900024961,
             0.821035883105467230906058078714215e-1,
             0.821035883105467230906058078714215e-1,
             0.753689235068359830728182576385735,
             0.821035883105467230906058078714215e-1,
             0.578195050519799725317663886414270e-2,
             0.578195050519799725317663886414270e-2,
             0.982654148484406008240470083407572,
             0.578195050519799725317663886414270e-2,
             0.50532740018894224425624528557907e-1,
             0.449467259981105775574375471442092,
             0.50532740018894224425624528557907e-1,
             0.449467259981105775574375471442092,
             0.50532740018894224425624528557907e-1,
             0.449467259981105775574375471442092,
             0.229066536116811139600408854554753,
             0.356395827885340437169173969506114e-1,
             0.229066536116811139600408854554753,
             0.356395827885340437169173969506114e-1,
             0.229066536116811139600408854554753,
             0.229066536116811139600408854554753,
             0.506227344977843677082264893939883,
             0.506227344977843677082264893939883,
             0.506227344977843677082264893939883,
             0.229066536116811139600408854554753,
             0.229066536116811139600408854554753,
             0.356395827885340437169173969506114e-1,
             0.366077495531974236787738546327104e-1,
             0.190486041934633455699433285315099,
             0.366077495531974236787738546327104e-1,
             0.366077495531974236787738546327104e-1,
             0.366077495531974236787738546327104e-1,
             0.190486041934633455699433285315099,
             0.736298458958971696943019005419480,
             0.736298458958971696943019005419480,
             0.736298458958971696943019005419480,
             0.366077495531974236787738546327104e-1,
             0.366077495531974236787738546327104e-1,
             0.190486041934633455699433285315099 };
      Eta = { 0.25,
              0.206829931610673204083980900024961,
              0.379510205167980387748057299925117,
              0.206829931610673204083980900024961,
              0.206829931610673204083980900024961,
              0.821035883105467230906058078714215e-1,
              0.753689235068359830728182576385735,
              0.821035883105467230906058078714215e-1,
              0.821035883105467230906058078714215e-1,
              0.578195050519799725317663886414270e-2,
              0.982654148484406008240470083407572,
              0.578195050519799725317663886414270e-2,
              0.578195050519799725317663886414270e-2,
              0.449467259981105775574375471442092,
              0.50532740018894224425624528557907e-1,
              0.50532740018894224425624528557907e-1,
              0.449467259981105775574375471442092,
              0.449467259981105775574375471442092,
              0.50532740018894224425624528557907e-1,
              0.356395827885340437169173969506114e-1,
              0.229066536116811139600408854554753,
              0.229066536116811139600408854554753,
              0.506227344977843677082264893939883,
              0.506227344977843677082264893939883,
              0.506227344977843677082264893939883,
              0.229066536116811139600408854554753,
              0.356395827885340437169173969506114e-1,
              0.229066536116811139600408854554753,
              0.229066536116811139600408854554753,
              0.356395827885340437169173969506114e-1,
              0.229066536116811139600408854554753,
              0.190486041934633455699433285315099,
              0.366077495531974236787738546327104e-1,
              0.366077495531974236787738546327104e-1,
              0.736298458958971696943019005419480,
              0.736298458958971696943019005419480,
              0.736298458958971696943019005419480,
              0.366077495531974236787738546327104e-1,
              0.190486041934633455699433285315099,
              0.366077495531974236787738546327104e-1,
              0.190486041934633455699433285315099,
              0.366077495531974236787738546327104e-1,
              0.366077495531974236787738546327104e-1 };
      Zeta = { 0.25,
               0.379510205167980387748057299925117,
               0.206829931610673204083980900024961,
               0.206829931610673204083980900024961,
               0.206829931610673204083980900024961,
               0.753689235068359830728182576385737,
               0.82103588310546723090605807871423e-1,
               0.821035883105467230906058078714225e-1,
               0.821035883105467230906058078714225e-1,
               0.982654148484406008240470083407571,
               0.5781950505197997253176638864142e-2,
               0.578195050519799725317663886414230e-2,
               0.578195050519799725317663886414260e-2,
               0.449467259981105775574375471442094,
               0.449467259981105775574375471442094,
               0.449467259981105775574375471442094,
               0.50532740018894224425624528557909e-1,
               0.50532740018894224425624528557909e-1,
               0.50532740018894224425624528557909e-1,
               0.506227344977843677082264893939883,
               0.506227344977843677082264893939883,
               0.506227344977843677082264893939883,
               0.229066536116811139600408854554753,
               0.229066536116811139600408854554753,
               0.35639582788534043716917396950611e-1,
               0.35639582788534043716917396950611e-1,
               0.229066536116811139600408854554753,
               0.229066536116811139600408854554753,
               0.35639582788534043716917396950611e-1,
               0.229066536116811139600408854554753,
               0.229066536116811139600408854554753,
               0.736298458958971696943019005419481,
               0.736298458958971696943019005419481,
               0.736298458958971696943019005419481,
               0.190486041934633455699433285315100,
               0.36607749553197423678773854632711e-1,
               0.36607749553197423678773854632711e-1,
               0.190486041934633455699433285315100,
               0.36607749553197423678773854632711e-1,
               0.366077495531974236787738546327106e-1,
               0.36607749553197423678773854632711e-1,
               0.190486041934633455699433285315100,
               0.366077495531974236787738546327106e-1 };
      break;
    case QuadratureFormula_type::VertexHexa:
      Weights = { 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0 };
      Xi = { -1.0,  1.0, -1.0,  1.0, -1.0,  1.0, -1.0,  1.0 };
      Eta = { -1.0, -1.0,  1.0,  1.0, -1.0, -1.0,  1.0,  1.0 };
      Zeta = { -1.0, -1.0, -1.0, -1.0, 1.0,  1.0,  1.0,  1.0 };
      break;
    case QuadratureFormula_type::Gauss2Hexa:
      Weights = { 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0 };
      Xi = {-0.5773502691896257645091489,  0.5773502691896257645091489,
            -0.5773502691896257645091489,  0.5773502691896257645091489,
            -0.5773502691896257645091489,  0.5773502691896257645091489,
            -0.5773502691896257645091489,  0.5773502691896257645091489};
      Eta = {-0.5773502691896257645091489, -0.5773502691896257645091489,
              0.5773502691896257645091489,  0.5773502691896257645091489,
             -0.5773502691896257645091489, -0.5773502691896257645091489,
              0.5773502691896257645091489,  0.5773502691896257645091489};
      Zeta = {-0.5773502691896257645091489, -0.5773502691896257645091489,
              -0.5773502691896257645091489, -0.5773502691896257645091489,
               0.5773502691896257645091489,  0.5773502691896257645091489,
               0.5773502691896257645091489,  0.5773502691896257645091489};
      break;
    case QuadratureFormula_type::Gauss3Hexa:
    {
      double oneweight[3]={ 5./9., 8./9., 5./9.};
      double onexi[3]={ -0.7745966692414833770358530, 
                         0,
                         0.7745966692414833770358530 };
      Weights = std::vector<double>(27);
      Xi = std::vector<double>(27);
      Eta = std::vector<double>(27);
      Zeta = std::vector<double>(27);
      for(int i=0;i<3;i++)
      {
        for(int j=0;j<3;j++)
        {
          for(int k=0;k<3;k++)
          {
            int l = 9*i+3*j+k;
            Weights[l] = oneweight[i]*oneweight[j]*oneweight[k];
            Xi[l] = onexi[k];
            Eta[l] = onexi[j];
            Zeta[l] = onexi[i];
          }
        }
      }
      break;
    }
    case QuadratureFormula_type::Gauss4Hexa:
    {
      double oneweight[4]={ 0.652145154862546142626936051,
                            0.347854845137453857373063949,
                            0.347854845137453857373063949,
                            0.652145154862546142626936051 };

      double onexi[4]={  0.33998104358485626480266576,
                         0.86113631159405257522394649,
                        -0.86113631159405257522394649,
                        -0.33998104358485626480266576 };
      Weights = std::vector<double>(64);
      Xi = std::vector<double>(64);
      Eta = std::vector<double>(64);
      Zeta = std::vector<double>(64);
      for(int i=0;i<4;i++)
      {
        for(int j=0;j<4;j++)
        {
          for(int k=0;k<4;k++)
          {
            int l = 16*i+4*j+k;
            Weights[l] = oneweight[i]*oneweight[j]*oneweight[k];
            Xi[l] = onexi[k];
            Eta[l] = onexi[j];
            Zeta[l] = onexi[i];
          }
        }
      }
      break;
    }
    case QuadratureFormula_type::Gauss5Hexa:
    {
      double oneweight[]={
                0.568888888888888888888888889,
                0.478628670499366468041291515,
                0.236926885056189087514264041,
                0.236926885056189087514264041,
                0.478628670499366468041291515
             };
      double onexi[]={
                0,
                0.538469310105683091036314421,
                0.906179845938663992797626878,
               -0.906179845938663992797626878,
               -0.538469310105683091036314421
             };
      Weights = std::vector<double>(125);
      Xi = std::vector<double>(125);
      Eta = std::vector<double>(125);
      Zeta = std::vector<double>(125);
      for(int i=0;i<5;i++)
      {
        for(int j=0;j<5;j++)
        {
          for(int k=0;k<5;k++)
          {
            int l = 25*i+5*j+k;
            Weights[l] = oneweight[i]*oneweight[j]*oneweight[k];
            Xi[l] = onexi[k];
            Eta[l] = onexi[j];
            Zeta[l] = onexi[i];
          }
        }
      }
      break;
    }
    case QuadratureFormula_type::Gauss6Hexa:
    {
      double oneweight[]={
               0.467913934572691047389870343990, 
               0.467913934572691047389870343990,
               0.360761573048138607569833513836, 
               0.171324492379170345040296142175,
               0.171324492379170345040296142175,
               0.360761573048138607569833513836
             };
      double onexi[]={
               -0.238619186083196908630501721681, 
                0.238619186083196908630501721681,
                0.661209386466264513661399595021, 
                0.932469514203152027812301554495,
               -0.932469514203152027812301554495,
               -0.661209386466264513661399595021
             };
      Weights = std::vector<double>(216);
      Xi = std::vector<double>(216);
      Eta = std::vector<double>(216);
      Zeta = std::vector<double>(216);
      for(int i=0;i<6;i++)
      {
        for(int j=0;j<6;j++)
        {
          for(int k=0;k<6;k++)
          {
            int l = 36*i+6*j+k;
            Weights[l] = oneweight[i]*oneweight[j]*oneweight[k];
            Xi[l] = onexi[k];
            Eta[l] = onexi[j];
            Zeta[l] = onexi[i];
          }
        }
      }
      break;
    }
    case QuadratureFormula_type::Gauss7Hexa:
    {
      double oneweight[]={
                0.381830050505118944950369775484,
                0.417959183673469387755102040812,
                0.381830050505118944950369775484,
                0.279705391489276667901467771426,
                0.129484966168869693270611432679,
                0.129484966168869693270611432679,
                0.279705391489276667901467771426
             };
      double onexi[]={
               -0.405845151377397166906606412077, 
                0,
                0.405845151377397166906606412077,
                0.741531185599394439863864773281, 
                0.949107912342758524526189684048,
               -0.949107912342758524526189684048, 
               -0.741531185599394439863864773281
             };
      Weights = std::vector<double>(343);
      Xi = std::vector<double>(343);
      Eta = std::vector<double>(343);
      Zeta = std::vector<double>(343);
      for(int i=0;i<7;i++)
      {
        for(int j=0;j<7;j++)
        {
          for(int k=0;k<7;k++)
          {
            int l = 49*i+7*j+k;
            Weights[l] = oneweight[i]*oneweight[j]*oneweight[k];
            Xi[l] = onexi[k];
            Eta[l] = onexi[j];
            Zeta[l] = onexi[i];
          }
        }
      }
      break;
    }
    case QuadratureFormula_type::Gauss8Hexa:
    {
      double oneweight[]={
                0.313706645877887287337962201982,
                0.362683783378361982965150449268,
                0.362683783378361982965150449268,
                0.313706645877887287337962201982,
                0.222381034453374470544355994424,
                0.101228536290376259152531354312,
                0.101228536290376259152531354312,
                0.222381034453374470544355994424
             };
      double onexi[]={
                -0.525532409916328985817739049189, 
                -0.183434642495649804939476142360,
                 0.183434642495649804939476142360, 
                 0.525532409916328985817739049189,
                 0.796666477413626739591553936476, 
                 0.960289856497536231683560868569,
                -0.960289856497536231683560868569,
                -0.796666477413626739591553936476
             }; 
      Weights = std::vector<double>(512);
      Xi = std::vector<double>(512);
      Eta = std::vector<double>(512);
      Zeta = std::vector<double>(512);
      for(int i=0;i<8;i++)
      {
        for(int j=0;j<8;j++)
        {
          for(int k=0;k<8;k++)
          {
            int l = 64*i+8*j+k;
            Weights[l] = oneweight[i]*oneweight[j]*oneweight[k];
            Xi[l] = onexi[k];
            Eta[l] = onexi[j];
            Zeta[l] = onexi[i];
          }
        }
      }
      break;
    }
    case QuadratureFormula_type::Gauss9Hexa:
    {
      double oneweight[]={
                0.260610696402935462318742869422, 
                0.312347077040002840068630406582,
                0.330239355001259763164525069284, 
                0.312347077040002840068630406582,
                0.260610696402935462318742869422, 
                0.180648160694857404058472031240,
                0.0812743883615744119718921581134,
                0.0812743883615744119718921581134,
                0.180648160694857404058472031240
             };
      double onexi[]={
               -0.613371432700590397308702039341, 
               -0.324253423403808929038538014644, 
                0,
                0.324253423403808929038538014644, 
                0.613371432700590397308702039341,
                0.836031107326635794299429788070, 
                0.968160239507626089835576202904,
               -0.968160239507626089835576202904,
               -0.836031107326635794299429788070
             }; 
      Weights = std::vector<double>(729);
      Xi = std::vector<double>(729);
      Eta = std::vector<double>(729);
      Zeta = std::vector<double>(729);
      for(int i=0;i<9;i++)
      {
        for(int j=0;j<9;j++)
        {
          for(int k=0;k<9;k++)
          {
            int l = 81*i+9*j+k;
            Weights[l] = oneweight[i]*oneweight[j]*oneweight[k];
            Xi[l] = onexi[k];
            Eta[l] = onexi[j];
            Zeta[l] = onexi[i];
          }
        }
      }
      break;
    }
    case QuadratureFormula_type::VerticesAndOrigin:
      Weights = {1./3., 1./3., 1./3., 1./3., 1./3., 1./3., 1./3., 1./3., 16./3.};
      Xi = { -1.0,  1.0, -1.0,  1.0, -1.0,  1.0, -1.0,  1.0, 0.0 };
      Eta = { -1.0, -1.0,  1.0,  1.0, -1.0, -1.0,  1.0,  1.0, 0.0 };
      Zeta = { -1.0, -1.0, -1.0, -1.0, 1.0,  1.0,  1.0,  1.0, 0.0 };
      break;
    case QuadratureFormula_type::VerticesAndOrigin15:
      Weights = { 1./9., 1./9., 1./9., 1./9.,
                  1./9., 1./9., 1./9., 1./9., - 56.0/9.0,
                  20./9., 20./9., 20./9., 20./9., 20./9., 20./9.};
      Xi = { -1.0,  1.0, -1.0,  1.0,
             -1.0,  1.0, -1.0,  1.0, 0.0,
              0.63245553203367586, 0.0, 0.0, -0.63245553203367586, 0.0, 0.0};
      Eta = { -1.0, -1.0,  1.0,  1.0,
              -1.0, -1.0,  1.0,  1.0, 0.0,
               0.0, 0.63245553203367586, 0.0, 0.0, -0.63245553203367586, 0.0};
      Zeta = { -1.0, -1.0, -1.0, -1.0,
                1.0,  1.0,  1.0,  1.0, 0.0,
                0.0, 0.0,  0.63245553203367586, 0.0, 0.0,  -0.63245553203367586};
      break;
    case QuadratureFormula_type::VerticesAndOrigin57:
    {
      double t0 = 0.010323148691722060, t1 = 0.69052862985186805;
      double t2 = 0.071977066056033603, t3 = 0.090534233349122512;
      double t4 = 0.14514879873706936;
      double x1 = 0.49757102301189591, x2 = 0.98959984011500087;
      double x3 = 0.87103917604353433, x4 = 0.53081040829645735;
      double x5 = 0.87906774032385155;
      Weights = { t0, t0, t0, t0,
                  t0, t0, t0, t0,
                  -1.2276013348603214,
                  t1, t1, t1, t1, t1, t1,
                  t2, t2, t2, t2, t2, t2,
                  t3, t3, t3, t3, t3, t3,
                  t3, t3, t3, t3, t3, t3,
                  t4, t4, t4, t4, t4, t4,
                  t4, t4, t4, t4, t4, t4,
                  t4, t4, t4, t4, t4, t4,
                  t4, t4, t4, t4, t4, t4};
      Xi = { -1.0,  1.0, -1.0,  1.0,
             -1.0,  1.0, -1.0,  1.0, 
             0.0,
             x1 , 0.0, 0.0, -x1, 0.0, 0.0,
             x2 , 0.0, 0.0, -x2, 0.0, 0.0,
             x3 , x3,  x3,  x3 , -x3, -x3,
             -x3 , -x3, 0.0, 0.0 , 0.0, 0.0,
             x4, x4,  x4,  x4, x4, x4,  x4,  x4,
             -x4, -x4,  -x4,  -x4, -x4, -x4,  -x4,  -x4,
             x5, x5, x5, x5, -x5, -x5, -x5, -x5
             };
      Eta = { -1.0, -1.0,  1.0,  1.0,
              -1.0, -1.0,  1.0,  1.0, 
              0.0,
              0.0, x1, 0.0, 0.0, -x1, 0.0,
              0.0, x2, 0.0, 0.0, -x2, 0.0,
              x3 , -x3 , 0.0, 0.0,  x3 , -x3,
              0.0, 0.0, x3, x3, -x3, -x3,
              x4,  -x4, x5, -x5, x4,  -x4, x5, -x5,
              x4,  -x4, x5, -x5, x4,  -x4, x5, -x5,
              x4, x4, -x4, -x4, x4, x4, -x4, -x4};
      Zeta = { -1.0, -1.0, -1.0, -1.0,
                1.0,  1.0,  1.0,  1.0, 0.0,
                0.0, 0.0, x1, 0.0, 0.0,  -x1,
                0.0, 0.0, x2, 0.0, 0.0,  -x2,
                0.0, 0.0, x3, -x3, 0.0, 0.0,
                x3, -x3, x3, -x3, x3, -x3,
                x5, x5, x4, x4,  -x5, -x5, -x4, -x4,
                x5, x5, x4, x4,  -x5, -x5, -x4, -x4,
                x4, -x4, x4, -x4, x4, -x4, x4, -x4
                };
      break;
    }
    case QuadratureFormula_type::Degree7_Points38:
    {
      double t0 = 0.29518973826262290, t1 = 0.40405541726620058;
      double t2 =0.12485075967894408; 
      double c0 = 0.90168780782129128;
      double c1 = 0.40837222149947467;
      double c2 = 0.85952309020105419;
      double c3 = 0.41473591372798772;
      Weights = { t0, t0, t0, t0, t0, t0,
                  t1, t1, t1, t1, t1, t1, t1, t1,
                  t2, t2, t2, t2, t2, t2, t2, t2, t2, t2,
                  t2, t2, t2, t2, t2, t2, t2, t2, t2, t2,
                  t2, t2, t2, t2 };
      Xi = { c0, 0, 0, -c0, 0, 0,
             c1, -c1, c1, c1, c1, -c1, -c1, -c1,
             c2, c2, c3, -c2, -c2, -c3, c2, c2, c3, c2, c2, c3,
             c2, c2, c3, -c2, -c2, -c3, -c2, -c2, -c3, -c2, -c2, -c3};
      Eta = { 0, c0, 0, 0, -c0, 0,
              c1, c1, -c1, c1, -c1, c1, -c1, -c1,
              c2, c3, c2, c2, c3, c2, -c2, -c3, -c2, c2, c3, c2,
              -c2, -c3, -c2, c2, c3, c2, -c2, -c3, -c2,-c2, -c3, -c2};
      Zeta = { 0, 0, c0, 0, 0, -c0,
               c1, c1, c1, -c1, -c1, -c1, c1, -c1,
               c3, c2, c2, c3, c2, c2, c3, c2, c2, -c3, -c2, -c2,
               -c3, -c2, -c2, -c3, -c2, -c2, c3, c2, c2, -c3, -c2, -c2};
      break;
    }
    default:
      ErrThrow("unknown type for quadrature formula ", type);
  }
  
  // some checks
  unsigned int n_points = Weights.size();
  if(n_points != Xi.size())
  {
    ErrThrow("the number of xi coordinates of this quadrature formula is not "
             "correct ", n_points, " !=" , Xi.size());
  }
  if(!Eta.empty() && n_points != Eta.size())
  {
    ErrThrow("the number of eta coordinates of this quadrature formula is not "
             "correct ", n_points, " !=" , Eta.size());
  }
  if(!Zeta.empty() && n_points != Zeta.size())
  {
    ErrThrow("the number of zeta coordinates of this quadrature formula is not "
             "correct ", n_points, " !=" , Zeta.size());
  }
  
  
  quadraturePairs.reserve(n_points);
  if(Eta.empty())
  {
    // 1D quadrature formula
    for(unsigned int i = 0; i < n_points; ++i)
    {
      parmoon::Point p(Xi[i]);
      quadraturePairs.push_back(std::make_pair(Weights[i], p));
    }
  }
  else if(Zeta.empty())
  {
    // 2D quadrature formula
    for(unsigned int i = 0; i < n_points; ++i)
    {
      parmoon::Point p(Xi[i], Eta[i]);
      quadraturePairs.push_back(std::make_pair(Weights[i], p));
    }
  }
  else
  {
    // 3D quadrature formula
    for(unsigned int i = 0; i < n_points; ++i)
    {
      parmoon::Point p(Xi[i], Eta[i], Zeta[i]);
      quadraturePairs.push_back(std::make_pair(Weights[i], p));
    }
  }
}

int TQuadFormula::GetAccuracy() const
{
  int accuracy = -1;
  switch(type)
  {
    case QuadratureFormula_type::Gauss1Line: accuracy = 1; break;
    case QuadratureFormula_type::Gauss2Line: accuracy = 3; break;
    case QuadratureFormula_type::Gauss3Line: accuracy = 5; break;
    case QuadratureFormula_type::Gauss4Line: accuracy = 7; break;
    case QuadratureFormula_type::Gauss5Line: accuracy = 9; break;
    case QuadratureFormula_type::Gauss6Line: accuracy = 11; break;
    case QuadratureFormula_type::Gauss7Line: accuracy = 13; break;
    case QuadratureFormula_type::Gauss8Line: accuracy = 15; break;
    case QuadratureFormula_type::Gauss9Line: accuracy = 17; break;
    case QuadratureFormula_type::Gauss10Line: accuracy = 19; break;
    case QuadratureFormula_type::Gauss11Line: accuracy = 21; break;
    case QuadratureFormula_type::Gauss12Line: accuracy = 23; break;
    case QuadratureFormula_type::Gauss2W1Line: accuracy = -1; break;
    case QuadratureFormula_type::Gauss4W1Line: accuracy = -1; break;
    case QuadratureFormula_type::Gauss6W1Line: accuracy = -1; break;
    case QuadratureFormula_type::Gauss8W1Line: accuracy = -1; break;
    case QuadratureFormula_type::Gauss16W2Line: accuracy = -1; break;
    /////////////////////////////////////////////////////////////////////////////
    case QuadratureFormula_type::BaryCenterTria: accuracy = 1; break;
    case QuadratureFormula_type::MidPointTria: accuracy = 2; break;
    case QuadratureFormula_type::SevenPointTria: accuracy = 3; break;
    case QuadratureFormula_type::Gauss3Tria: accuracy = 5; break;
    case QuadratureFormula_type::VertexTria: accuracy = 1; break;
    case QuadratureFormula_type::Degree8Tria: accuracy = 8; break;
    case QuadratureFormula_type::Degree9Tria: accuracy = 9; break;
    case QuadratureFormula_type::Degree11Tria: accuracy = 11; break;
    case QuadratureFormula_type::Degree19Tria: accuracy = 19; break;
    case QuadratureFormula_type::Gauss2Quad: accuracy = 3; break;
    case QuadratureFormula_type::Gauss3Quad: accuracy = 5; break;
    case QuadratureFormula_type::Gauss4Quad: accuracy = 7; break;
    case QuadratureFormula_type::Gauss5Quad: accuracy = 9; break;
    case QuadratureFormula_type::Gauss6Quad: accuracy = 11; break;
    case QuadratureFormula_type::Gauss7Quad: accuracy = 13; break;
    case QuadratureFormula_type::Gauss8Quad: accuracy = 15; break;
    case QuadratureFormula_type::Gauss9Quad: accuracy = 17; break;
    case QuadratureFormula_type::VertexQuad: accuracy = 1; break;
    case QuadratureFormula_type::SimpsonQuad: accuracy = 3; break;
    case QuadratureFormula_type::CompGauss3Tria: accuracy = 5; break;
    case QuadratureFormula_type::CompGauss4Tria: accuracy = 5; break;
    case QuadratureFormula_type::Gauss_Degree8Tria: accuracy = 8; break;
    /////////////////////////////////////////////////////////////////////////////
    case QuadratureFormula_type::BaryCenterTetra: accuracy = 1; break;
    case QuadratureFormula_type::VertexTetra: accuracy = 1; break;
    case QuadratureFormula_type::P2Tetra: accuracy = 2; break;
    case QuadratureFormula_type::P4Tetra: accuracy = 4; break;
    case QuadratureFormula_type::P5Tetra: accuracy = 5; break;
    case QuadratureFormula_type::P8Tetra: accuracy = 8; break;
    case QuadratureFormula_type::VertexHexa: accuracy = 1; break;
    case QuadratureFormula_type::Gauss2Hexa: accuracy = 3; break;
    case QuadratureFormula_type::Gauss3Hexa: accuracy = 5; break;
    case QuadratureFormula_type::Gauss4Hexa: accuracy = 7; break;
    case QuadratureFormula_type::Gauss5Hexa: accuracy = 9; break;
    case QuadratureFormula_type::Gauss6Hexa: accuracy = 11; break;
    case QuadratureFormula_type::Gauss7Hexa: accuracy = 13; break;
    case QuadratureFormula_type::Gauss8Hexa: accuracy = 15; break;
    case QuadratureFormula_type::Gauss9Hexa: accuracy = 17; break;
    case QuadratureFormula_type::VerticesAndOrigin: accuracy = 1; break;
    case QuadratureFormula_type::VerticesAndOrigin15: accuracy = 1; break;
    case QuadratureFormula_type::VerticesAndOrigin57: accuracy = 1; break;
    case QuadratureFormula_type::Degree7_Points38: accuracy = 1; break;
    default:
      ErrThrow("unknown type for quadrature formula ", type);
  }
  return accuracy;
}


bool TQuadFormula::is_on_simplices() const
{
  switch(type)
  {
    case QuadratureFormula_type::Gauss1Line:
    case QuadratureFormula_type::Gauss2Line:
    case QuadratureFormula_type::Gauss3Line:
    case QuadratureFormula_type::Gauss4Line:
    case QuadratureFormula_type::Gauss5Line:
    case QuadratureFormula_type::Gauss6Line:
    case QuadratureFormula_type::Gauss7Line:
    case QuadratureFormula_type::Gauss8Line:
    case QuadratureFormula_type::Gauss9Line:
    case QuadratureFormula_type::Gauss10Line:
    case QuadratureFormula_type::Gauss11Line:
    case QuadratureFormula_type::Gauss12Line:
    case QuadratureFormula_type::Gauss2W1Line:
    case QuadratureFormula_type::Gauss4W1Line:
    case QuadratureFormula_type::Gauss6W1Line:
    case QuadratureFormula_type::Gauss8W1Line:
    case QuadratureFormula_type::Gauss16W2Line:
    ///////////////////////////////////////////////////////////////////////////
    case QuadratureFormula_type::BaryCenterTria:
    case QuadratureFormula_type::MidPointTria:
    case QuadratureFormula_type::SevenPointTria:
    case QuadratureFormula_type::Gauss3Tria:
    case QuadratureFormula_type::VertexTria:
    case QuadratureFormula_type::Degree8Tria:
    case QuadratureFormula_type::Degree9Tria:
    case QuadratureFormula_type::Degree11Tria:
    case QuadratureFormula_type::Degree19Tria:
    case QuadratureFormula_type::CompGauss3Tria:
    case QuadratureFormula_type::CompGauss4Tria:
    case QuadratureFormula_type::Gauss_Degree8Tria:
    ///////////////////////////////////////////////////////////////////////////
    case QuadratureFormula_type::BaryCenterTetra:
    case QuadratureFormula_type::VertexTetra:
    case QuadratureFormula_type::P2Tetra:
    case QuadratureFormula_type::P4Tetra:
    case QuadratureFormula_type::P5Tetra:
    case QuadratureFormula_type::P8Tetra:
      return true;
      break;

    case QuadratureFormula_type::Gauss2Quad:
    case QuadratureFormula_type::Gauss3Quad:
    case QuadratureFormula_type::Gauss4Quad:
    case QuadratureFormula_type::Gauss5Quad:
    case QuadratureFormula_type::Gauss6Quad:
    case QuadratureFormula_type::Gauss7Quad:
    case QuadratureFormula_type::Gauss8Quad:
    case QuadratureFormula_type::Gauss9Quad:
    case QuadratureFormula_type::VertexQuad:
    case QuadratureFormula_type::SimpsonQuad:

    case QuadratureFormula_type::VertexHexa:
    case QuadratureFormula_type::Gauss2Hexa:
    case QuadratureFormula_type::Gauss3Hexa:
    case QuadratureFormula_type::Gauss4Hexa:
    case QuadratureFormula_type::Gauss5Hexa:
    case QuadratureFormula_type::Gauss6Hexa:
    case QuadratureFormula_type::Gauss7Hexa:
    case QuadratureFormula_type::Gauss8Hexa:
    case QuadratureFormula_type::Gauss9Hexa:
    case QuadratureFormula_type::VerticesAndOrigin:
    case QuadratureFormula_type::VerticesAndOrigin15:
    case QuadratureFormula_type::VerticesAndOrigin57:
    case QuadratureFormula_type::Degree7_Points38:
      return false;
      break;
    default:
      ErrThrow("unknown QuadratureFormula_type", type);
      break;
  }
}

int TQuadFormula::get_dimension() const
{
  if(!Zeta.empty())
    return 3;
  if(!Eta.empty())
    return 2;
  return 1;
}


void TQuadFormula::info() const
{
  Output::print("This is a quadrature formula of type ", this->type);
  Output::print("It has the accuracy ", GetAccuracy(), " and ",
                quadraturePairs.size(), " quadrature points.");
  for(unsigned int i = 0; i < quadraturePairs.size(); i++)
  {
    Output::print<4>(" The quadrature point number ", i + 1,
                     " has the coordinate/s: ");
    Output::print<4>(" x:", quadraturePairs.at(i).second.x);

    if(get_dimension() == 2)
    {
      Output::print<4>(" y: ", quadraturePairs.at(i).second.y);
    }
    if(get_dimension() == 3)
    {
      Output::print<4>(" z: ", quadraturePairs.at(i).second.z);
    }
    Output::print<4>(" Its weight is ", quadraturePairs.at(i).first);
  }
}

void TQuadFormula::GetFormulaData(int &n_points, const double* &weights,
                                  const double* &xi) const
{
  n_points=GetN_QuadPoints();
  weights=&Weights[0];
  xi=&Xi[0];
}

void TQuadFormula::GetFormulaData(int &n_points, const double* &weights,
                                  const double* &xi, const double* &eta) const
{
  n_points=GetN_QuadPoints();
  weights=&Weights[0];
  xi=&Xi[0];
  eta=&Eta[0];
}

void TQuadFormula::GetFormulaData(int &n_points, const double* &weights,
                                  const double* &xi, const double* &eta,
                                  const double* &zeta) const
{
  n_points = GetN_QuadPoints();
  weights = &Weights[0];
  xi = &Xi[0];
  eta = &Eta[0];
  zeta = &Zeta[0];
}
